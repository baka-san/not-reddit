<div class="posts-show">

  <p class="page-path">
    <%= link_to "Topics", topics_path %> 
    > <%= link_to @post.topic.name, @post.topic %> 
    > <%= @post.title %> 
  </p> 


  <div class="row post-info">
    <div class="col-xs-1 voting-controls">
     <%= render partial: 'votes/voting', locals: { post: @post } %>
    </div>
    <div class="col-xs-10 col-xs-push-1 col-md-11 col-md-push-0 post-details">
      <h2>
        <strong class="post-title"><%= @post.title %> </strong><br>
        <small><%= simple_format(@post.body) %></small>
      </h2>
      <small>
        <%= pluralize(@post.comments.count, "comment")%> | 
        Submitted <%= time_ago_in_words(@post.created_at) %> ago by <%= link_to @post.user.name, user_path(@post.user) %>
      </small>
    </div>
  </div>

  <div class="row post-body">
    <div class="col-md-8">
      <div class="comments-section">
        <h2>Comments</h2>
        <% @post.comments.each do |comment| %>
          <div class="col col-xs-1">
            <% avatar_url = comment.user.avatar_url(40) %>
            <% if avatar_url %>
              <div class="media-left">
                <%= image_tag avatar_url, class: 'media-object .img-fluid' %>
              </div>
            <% end %>
          </div>
          <div class="col col-xs-11">
            <%= render partial: 'comments/comment', locals: { comment: comment } %>
          </div>
        <% end %>
      </div>

      <% if current_user %>
        <%= render 'comments/form', comment: Comment.new, post: @post %>
      <% end %>
    </div>

    <% if user_is_authorized_for_posts?(@post) %>
      <div class="col-md-4 edit-delete">
        <%= link_to "Edit", edit_topic_post_path(@post.topic, @post), class: 'btn btn-success' %>
        <%= link_to "Delete Post", [@post.topic, @post], method: :delete, class: 'btn btn-danger', data: {confirm: 'Are you sure you want to delete this post?'} %>
      </div>
    <% end %>

    <div class="col-md-4 points-summary">
      <h3>
        <%= pluralize(@post.points, 'point') %>
        <div>
          <small>
            <%= pluralize(@post.up_votes, 'up vote') %>,
            <%= pluralize(@post.down_votes, 'down vote') %>
          </small>
        </div>
      </h3>

      <% if current_user %>
        <%= render partial: 'favorites/favorite', locals: { post: @post } %>
      <% end %>
    </div>
  </div>
</div>
